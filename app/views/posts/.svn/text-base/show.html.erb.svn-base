<% content_for :page_script do %>
<script type="text/javascript">

var audioid;

function setAudioID(num) {
	audioid = num;
	$("comment_audio_id").value = num;
}

</script>
<% end %>

<% stylesheet 'post' %>

<% content_for :title do %> LinguaZone - <%= @post.course.name %> - Audio Blog - <%= @post.title %> <% end %>

<div id="title" onmouseover="document.getElementById('post_controls').style.display = 'block'" 
				onmouseout="document.getElementById('post_controls').style.display = 'none'">
	<h1><%= @post.title %></h1>
	<p class="date"><%= format_date(@post.updated_at) %></p>
	<br class="clearFloat" />
</div>

<div id="post" onmouseover="document.getElementById('post_controls').style.display = 'block'" 
				onmouseout="document.getElementById('post_controls').style.display = 'none'">
	<% if @post.audio_id == 0 %>
		<p><%= @post.content %></p>
	<% else %>
		<div style="margin-top: 10px">
			<div style="float: left; margin: 0px 15px;">
				<%= swf_tag "audio-widget", {:size => "215x138", :flashvars => "audio_id="+String(@post.audio_id)} %>
			</div>
			<p><%= @post.content %></p>
			<br class="clearFloat" />
		</div>
	<% end %>
	<% if is_teacher_for(@post.course) %>
		<ul id="post_controls" class="controls">
			<li>Teacher controls:</li>
			<li><%= link_to "Edit post", edit_post_path(@post) %></li>
			<li><%= link_to "Delete post", @post, :method => "DELETE" %></li>
		</ul>
	<% end %>
</div>

<p><%= link_to 'Back to class page', :controller => "courses", :action => "show", :id => @post.course_id %></p>

<hr />

<div id="comments">
	<h2>Comments</h2>
	<% if @post.comments.length == 0 %>
		<p>No comments have been left on this post yet.</p>
	<% else %>
		<% if @post.shared? %>
			<%= render :partial => 'comment', :collection => @post.comments %>
		<% else %>
			<% if is_teacher_for (@post.course) %>
				<p>Students cannot see each other's comments &mdash; only you can see student comments.</p>
				<%= render :partial => 'comment', :collection => @post.comments %>
			<% else %>
				<p>You have left <%= pluralize(@student_comments.length, 'comment') %> on this post.</p>
				<%= render :partial => 'comment', :collection => @student_comments %>
			<% end %>
		<% end %>
	<% end %>
</div>

<%= render :partial => 'new_comment' %>


<%= link_to 'Back to class page', :controller => "courses", :action => "show", :id => @post.course_id %>